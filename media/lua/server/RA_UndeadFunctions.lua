--[[⠀
----------------------------------------------------------------------------------------------------------------------------⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀                       ⠀⢀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⣀⣀⣀⣀⣰⣦⣀⣀⠀⠠⠄⠄⠠⠀⠀⢀⣠⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⡿⢿⣦⠀⠀⠀⠀⠀⠀⠀⢀⡷⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⣩⡿⠋⠙⠉⢩⡿⠟⠀⠀⠀⠀⠀⠀⢀⣶⣾⠟⠋⠛⣿⣷⡄⠀⠀⠀⠀⠀⣴⣿⠂⠀⠀⣼⡿⠀⠀⠀⠀⠀⠀⢀⣠⡴⠶⣤⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⠦⠤⣤⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⡿⠋⠀⢸⠏⠀⠀⠀⠀⠀⠀⠀⣼⠃⠀⠀⠀⠀⢠⡇⠀⠀⠀⢠⣾⠋⠀⠀⠀⠀⣸⠀⠀⠀⠀⠀⠀⠀⢠⣿⠋⠀⠀⠀⠀⠛⠛⠁⠀⠀⠀⢀⣾⣿⠏⠀⠀⢀⡿⠃⠀⠀⠀⠀⠀⠶⠋⠁⢀⣰⠟⠀⠀⠀⠀⠀⠀⠀⣹⣿⠀⠀⠀⠀⣨⣿⠇⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⣾⡟⢀⣠⣤⣴⣶⠆⠀⠀⠀⠀⠀⢰⠃⠀⠀⠀⠀⠀⣾⠀⠀⠀⣰⣿⠃⠀⠀⠀⠀⠀⣿⡀⠀⠀⠀⠀⠀⢀⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⠋⠀⠀⢀⡾⠁⠀⠀⠀⠀⠀⠀⠀⣠⣶⣯⣅⡀⠀⠀⠀⠀⠀⠀⠀⣿⡇⢀⣠⠴⠞⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣸⡟⠀⠛⠉⣠⣾⠃⠀⠀⠀⠀⠀⠀⣼⠀⠀⠀⠀⠀⠀⢿⣤⡴⢺⢻⠃⠀⠀⠀⠀⠀⢸⡿⠁⠀⠀⠀⠀⠀⠀⢿⠀⠀⠀⠀⢀⣤⠀⠀⠀⠀⠀⢀⣿⣇⡤⠤⢤⣾⣤⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢻⡆⠀⠀⠀⠀⠀⣿⣯⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣿⠃⠀⠀⢀⣼⠇⠀⠀⠀⠀⠀⠀⣰⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⢂⠇⠀⠀⠀⠀⠀⠀⣾⡅⠀⠀⠀⠀⠀⠀⠀⢸⣧⡀⠀⠀⣼⠇⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠐⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠃⠀⠀⠀⠀⠀⢰⡏⠘⣦⠀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠘⢧⣤⡶⠟⢻⠀⠀⠀⠀⠀⠀⢠⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⢘⠏⠀⠀⠀⠀⠀⠀⢰⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠙⠿⣶⡾⠋⠀⠀⠀⠀⠀⠀⢸⡟⠀⠀⠀⢰⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠞⠁⠀⠀⠀⠀⠀⠀⠁⠀⠈⠙⠂⠔⠊⠁⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠀⠀⠀⠀⠀⢀⣿⣤⠶⠒⠒⠁⠀⠀⠀⠀⢠⠏⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠐⠊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

----------------------------------------------------------------------------------------------------------------------------
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
Please contact me if you need to hire someone to do mods or other design related tasks
https://steamcommunity.com/id/glytch3r/myworkshopfiles/
https://www.glytch3r.com
https://ko-fi.com/glytch3r
Discord: Glytch3r#2892

----------------------------------------------------------------------------------------------------------------------------
--]]
--[[ require "lua_timers" ]]
--[[ require "undeadMenu1"
 ]]
-- local tick = tick or 0
-- local tock = tock or 0
--print(getPlayer():getModData()['printzed'])
--getPlayer():getModData()['printzed'] = true
-- function undeadClock(ticks)
-- if ticks % 15 and getPlayer():getModData()['printzed'] then
-- getPlayer():setHaloNote(tostring(getPlayer():getStats():getNumChasingZombies(),200,100,100,200))
-- --getNumVisibleZombies)_
-- --getNumChasingZombies()
-- end
-- end
-- Events.OnTick.Remove(undeadClock)
-- Events.OnTick.Add(undeadClock)


-- function hpBuffer(player, source, float)

-- local bodyDamage = player:getBodyDamage();
-- local bodyParts = bodyDamage:getBodyParts();
-- --if source == 'POISON' then


-- bodyDamage:setOverallBodyHealth(bodyDamage:getOverallBodyHealth() + float)
-- if player and player == getPlayer() and  getPlayer():getModData()['glytchprint'] then
-- tostring(player:getBodyDamage():getOverallBodyHealth())
-- end
-- --end
-- --[[         if bodyDamage:getFoodSicknessLevel() ~= 0 then bodyDamage:setFoodSicknessLevel(0); return end
-- if bodyDamage:getPoisonLevel() ~= 0 then bodyDamage:setPoisonLevel(0); return end ]]
-- end

-- Events.OnPlayerGetDamage.Add(hpBuffer)


--[[

		local player = getPlayer()
		local bodyDamage = player:getBodyDamage();
		bodyDamage:setOverallBodyHealth(100)
		local bodyParts = bodyDamage:getBodyParts();	
    for i=bodyParts:size()-1, 0, -1  do
		local bodyPart = bodyParts:get(i);
 	    bodyPart:setWoundInfectionLevel(0);	
        bodyPart:setDeepWoundTime(0)
        bodyPart:setBleedingTime(0)
        bodyPart:setBurnTime(0)
        bodyPart:setFractureTime(0)
        bodyPart:setScratchTime(0)
        bodyPart:setCutTime(0)
       bodyPart:SetInfected(false);
		bodyPart:setInfectedWound(false);
		bodyPart:SetFakeInfected(false);	
		bodyPart:setDeepWounded(false)
		bodyPart:SetBitten(false);
    end
player:getStats():setHunger(0)
player:getStats():setFatigue(0)
player:getStats():setBoredom(0)
player:getStats():setEndurance(100)
player:getStats():setSickness(0)
player:getStats():setThirst(0)
player:getStats():setFear(0)
player:getStats():setStress(0)
player:getStats():setDrunkenness(0)
player:getStats():setPanic(0)
player:getStats():setAnger(0)
player:getStats():setStressFromCigarettes(0)
bodyDamage:setFoodSicknessLevel(0)
bodyDamage:setPoisonLevel(0)
bodyDamage:setUnhappynessLevel(0)
bodyDamage:setBoredomLevel(0)
bodyDamage:setWetness(0)
 ]]
------------------------------------------
------------------ Init ------------------
------------------------------------------

local function OnGameStart()
	if getPlayer() then
		local pl = getPlayer()
		if not pl:getModData()['zedblaze'] == nil then pl:getModData()['zedblaze'] = false end
		if not pl:getModData()['zeddeath'] == nil then pl:getModData()['zeddeath'] = false end
		if not pl:getModData()['zedstag'] == nil then pl:getModData()['zedstag'] = false end
		if not pl:getModData()['glytchviral'] == nil then pl:getModData()['glytchviral'] = false end
		if not pl:getModData()['glytchprint'] == nil then pl:getModData()['glytchprint'] = false end
		if not pl:getModData()['glytch3rPranked'] == nil then pl:getModData()['glytch3rPranked'] = false end
		if not pl:getModData()['undeadheal'] == nil then pl:getModData()['undeadheal'] = false end
		if not pl:getModData()['isUndead'] == nil then pl:getModData()['isUndead'] = false end
	end
end

Events.OnGameStart.Add(OnGameStart)



----------------------------------------
---------- Various functions ----------
----------------------------------------

-- Used to prevent various injuries to a player-zed
local function ManageZedInjuries()
	local player = getPlayer()
	local body_damage = player:getBodyDamage()
	local body_parts = body_damage:getBodyParts()
	for i = body_parts:size() - 1, 0, -1 do
		local bodyPart = body_parts:get(i)

		bodyPart:SetInfected(false);
		bodyPart:setInfectedWound(false)
		bodyPart:SetFakeInfected(false)
		bodyPart:setWoundInfectionLevel(0)
		bodyPart:setDeepWoundTime(0)
		bodyPart:setDeepWounded(false)
		bodyPart:setBleedingTime(0)
		bodyPart:setBurnTime(0)
		bodyPart:SetBitten(false);
		bodyPart:setFractureTime(0)
		bodyPart:setStiffness(0)
		player:getFitness():removeStiffnessValue(BodyPartType.ToString(bodyPart:getType()))
		bodyPart:setScratched(false, true)

		bodyPart:setScratchTime(0)
		bodyPart:setCutTime(0)
		local deepWound = bodyPart:isDeepWounded()
		local deepWoundTime = bodyPart:getDeepWoundTime()
		local bleedTime = bodyPart:getBleedingTime()
		bodyPart:setHaveBullet(false, 0)
		bodyPart:setDeepWoundTime(deepWoundTime)
		bodyPart:setDeepWounded(deepWound)
		bodyPart:setBleedingTime(bleedTime)
	end
end

local function StartZedScream()
	local pl = getPlayer()
	getSoundManager():PlayWorldSound('SOSv1', pl:getSquare(), 0, 5, 5, false)
	addSound(pl, pl:getX(), pl:getY(), pl:getZ(), 50, 1)
end



function glytchinjury()
	local pl = getPlayer()
	local bodyDamage = pl:getBodyDamage();
	local bodyParts = bodyDamage:getBodyParts();
	for i = bodyParts:size() - 1, 0, -1 do
		local bodyPart = bodyParts:get(i);

		bodyPart:SetInfected(false);
		bodyPart:setInfectedWound(false);
		bodyPart:SetFakeInfected(false);
		bodyPart:setWoundInfectionLevel(0);
		bodyPart:setDeepWoundTime(0)
		bodyPart:setDeepWounded(false)
		bodyPart:setBleedingTime(0)
		bodyPart:setBurnTime(0)
		bodyPart:SetBitten(false);
		bodyPart:setFractureTime(0)
		bodyPart:setStiffness(0)
		pl:getFitness():removeStiffnessValue(BodyPartType.ToString(bodyPart:getType()))
		bodyPart:setScratched(false, true)

		bodyPart:setScratchTime(0)
		bodyPart:setCutTime(0)
		local deepWound = bodyPart:isDeepWounded()
		local deepWoundTime = bodyPart:getDeepWoundTime()
		local bleedTime = bodyPart:getBleedingTime()
		bodyPart:setHaveBullet(false, 0)
		bodyPart:setDeepWoundTime(deepWoundTime)
		bodyPart:setDeepWounded(deepWound)
		bodyPart:setBleedingTime(bleedTime)
	end
end



local tickTock = 0


-- What does this do?
function undeadRecovery(pl)
	if tickTock == 149 then
		tickTock = 0
	else
		tickTock = tickTock + 1
		return
	end
	if pl:getBodyDamage():getOverallBodyHealth() <= 20 then
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth())), 255, 23, 23, 100)
	elseif pl:getBodyDamage():getOverallBodyHealth() <= 50 then
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth())), 153, 153, 23, 100)
	else
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth())))
	end
	if pl and pl:getModData()['undeadheal'] then
		pl:getStats():setHunger(0)
		pl:getStats():setFatigue(0)
		pl:getStats():setBoredom(0)
		pl:getStats():setEndurance(100)
		pl:getStats():setSickness(0)
		pl:getStats():setThirst(0)
		pl:getStats():setFear(0)
		pl:getStats():setStress(0)
		pl:getStats():setDrunkenness(0)
		pl:getStats():setPanic(0)
		pl:getStats():setAnger(0)
		pl:getStats():setStressFromCigarettes(0)
		--pl:getBodyDamage():setTimeSinceLastSmoke(0)
		pl:getNutrition():setCalories(700)
		pl:getBodyDamage():setBoredomLevel(0)
		pl:getBodyDamage():setUnhappynessLevel(0)
		pl:getBodyDamage():decreaseBodyWetness(pl:getBodyDamage():getWetness())
		pl:getBodyDamage():setHasACold(false);
		pl:getBodyDamage():setInfected(false);
		pl:getBodyDamage():setFakeInfectionLevel(0);
		pl:getBodyDamage():setInfectionLevel(0);
		pl:getBodyDamage():setFoodSicknessLevel(0);
		--pl:getBodyDamage():getHealth()
	end
end
Events.OnPlayerUpdate.Remove(undeadRecovery)










